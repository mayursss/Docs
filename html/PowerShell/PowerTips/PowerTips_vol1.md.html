<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>PowerTips_vol1</title>
      <link rel="stylesheet" href="../../styles.css">
  </head>
  <body class='markdown-preview' data-use-github-style><ul>
  <li><a href="#1-resolving-paths">1. Resolving Paths</a></li>
  <li><a href="#2-sophisticated-directory-filtering-in-powershell-30">2. Sophisticated Directory Filtering in PowerShell 3.0</a></li>
  <li><a href="#3-finding-files-only-or-folders-only">3. Finding Files Only or Folders Only</a></li>
  <li><a href="#4-adding-personal-drives-in-powershell">4. Adding Personal Drives in PowerShell</a></li>
  <li><a href="#5-discovering-file-system-related-cmdlets">5. Discovering File System-related Cmdlets</a></li>
  <li><a href="#6-clean-your-temp-folder-with-powershell">6. Clean Your Temp Folder with PowerShell</a></li>
  <li><a href="#7-unblocking-and-unpacking-zip-files">7. Unblocking and Unpacking ZIP Files</a></li>
  <li><a href="#8-find-open-files">8. Find Open Files</a></li>
  <li><a href="#9-finding-newest-or-oldest-files">9. Finding Newest or Oldest Files</a></li>
  <li><a href="#10-finding-duplicate-files">10. Finding Duplicate Files</a></li>
  <li><a href="#11-finding-old-files">11. Finding Old Files</a></li>
  <li><a href="#12-finding-system-folders">12. Finding System Folders</a></li>
  <li><a href="#13-hiding-drive-letters">13. Hiding Drive Letters</a></li>
  <li><a href="#14-checking-total-size-of-downloads-folder">14. Checking Total Size of Downloads-Folder</a></li>
  <li><a href="#15-sharing-folders">15. Sharing Folders</a></li>
  <li><a href="#16-shrinking-paths">16. Shrinking Paths</a></li>
  <li><a href="#17-how-large-are-my-folders">17. How Large Are My Folders?</a></li>
  <li><a href="#18-bulk-renaming-files">18. Bulk-Renaming Files</a></li>
  <li><a href="#19-monitoring-folder-content">19. Monitoring Folder Content</a></li>
  <li><a href="#20-open-file-exclusively">20. Open File Exclusively</a></li>
  <li><a href="#21-removing-file-extensions">21. Removing File Extensions</a></li>
  <li><a href="#22-quickly-changing-file-extensions">22. Quickly Changing File Extensions</a></li>
  <li><a href="#23-grouping-files-based-on-size">23. Grouping Files Based on Size</a></li>
  <li><a href="#24-open-many-files-with-one-command">24. Open Many Files with One Command</a></li>
  <li><a href="#25-use-multiple-wildcards">25. Use Multiple Wildcards</a></li>
  <li><a href="#26-filtering-multiple-file-types">26. Filtering Multiple File Types</a></li>
  <li><a href="#27-creating-shortcuts-on-your-desktop">27. Creating Shortcuts on your Desktop</a></li>
  <li><a href="#28-create-files-and-folders-in-one-step">28. Create Files and Folders in One Step</a></li>
  <li><a href="#29-remove-recents-folder">29. Remove Recents Folder</a></li>
  <li><a href="#30-displaying-hex-dumps">30. Displaying Hex Dumps</a></li>
  <li><a href="#31-reading-file-magic-number">31. Reading File “Magic Number”</a></li>
  <li><a href="#32-rename-drive-label">32. Rename Drive Label</a></li>
  <li><a href="#33-no-need-for-virtual-drives">33. No Need for Virtual Drives</a></li>
  <li><a href="#34-temporary-file-name">34. Temporary File Name</a></li>
  <li><a href="#35-creating-large-dummy-files-with-net">35. Creating Large Dummy Files with .NET</a></li>
  <li><a href="#36-does-a-folder-contain-a-specific-file">36. Does a Folder Contain a Specific File?</a></li>
  <li><a href="#37-file-or-folder-find-out">37. File or Folder? Find Out!</a></li>
  <li><a href="#38-list-hidden-files">38. List Hidden Files</a></li>
  <li><a href="#39-converting-file-system-to-ntfs">39. Converting File System to NTFS</a></li>
  <li><a href="#40-reading-and-writing-drive-labels">40. Reading and Writing Drive Labels</a></li>
  <li><a href="#41-determining-a-drives-file-system">41. Determining a Drives’ File System</a></li>
  <li><a href="#42-removing-illegal-file-name-characters">42. Removing Illegal File Name Characters</a></li>
  <li><a href="#43-using-simple-path-analysis">43. Using Simple Path Analysis</a></li>
  <li><a href="#44-getting-real-paths">44. Getting Real Paths</a></li>
  <li><a href="#45-select-folder-dialog">45. Select Folder-Dialog</a></li>
  <li><a href="#46-quick-drive-info">46. Quick Drive Info</a></li>
  </ul>

<h1 id="1-resolving-paths">1. Resolving Paths</h1>
<p>Paths can be relative, such as <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">“.\file.txt”</code>. To resolve such a path and display its full path, you could use Resolve-Path:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Resolve-Path</span></span><span>&nbsp;.\file.txt</span></span></div></pre>
<p>Unfortunately, though, Resolve-Path expects the file to really exist, so you cannot use it on hypothetical paths. To resolve all paths, whether they exist or not, use this line instead:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--variable syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>ExecutionContext</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.SessionState.Path.GetUnresolvedProviderPathFromPSPath</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>.\file.txt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>C:\Users\Tobias\file.txt</span></span></div></pre><h1 id="2-sophisticated-directory-filtering-in-powershell-3-0">2. Sophisticated Directory Filtering in PowerShell 3.0</h1>
<p>In PowerShell 3.0, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Get-ChildItem</code> now supports sophisticated filtering through its <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">-Attributes</code> parameter. To get all files in your Windows
folder or one of its subfolders that are not system files but are encrypted or compressed, use something like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Attributes&nbsp;</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>Directory</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>System</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>Encrypted</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>Directory</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>System</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>Compressed</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ErrorAction&nbsp;SilentlyContinue</span></span></div></pre>
<blockquote>
<p>(Note how “!” negates the filter.)<br>
The -Attributes parameter supports these attributes: Archive, Compressed, Device, Directory, Encrypted, Hidden, Normal,
NotContentIndexed, Offline, ReadOnly, ReparsePoint, SparseFile, System, and Temporary.</p>
</blockquote>
<h1 id="3-finding-files-only-or-folders-only">3. Finding Files Only or Folders Only</h1>
<p>In PowerShell 2.0, to list only files or only folders you had to do filtering yourself:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.PSIsContainer</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>true</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.PSIsContainer</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>false</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>In PowerShell 3.0, Get-ChildItem is smart enough to do that for you:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>File</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Directory</span></span></div></pre>
<h1 id="4-adding-personal-drives-in-powershell">4. Adding Personal Drives in PowerShell</h1>
<p>PowerShell enables you to create custom drives with custom drive names (New-PSDrive). Here’s a piece of code that you can place into
your profile script (path to this script is found in $profile, and the profile script may be created first).
It adds useful system folders as named PowerShell drives to your PowerShell environment:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Add-PersonalDrive</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.Enum</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetNames</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.Environment</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>SpecialFolder</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>name</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>target</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.Environment</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFolderPath</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-PSDrive</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>name</span></span><span>&nbsp;FileSystem&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>target</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Scope&nbsp;Global</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Once you run the function, you get a whole lot of new drives, for example Desktop: or MyDocuments:</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Name&nbsp;Used&nbsp;(GB)&nbsp;Free&nbsp;(GB)&nbsp;Provider&nbsp;Root</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>----&nbsp;---------&nbsp;---------&nbsp;--------&nbsp;----</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Desktop&nbsp;2,39&nbsp;FileSystem&nbsp;C:\Users\Tobias\Desktop</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Programs&nbsp;2,39&nbsp;FileSystem&nbsp;C:\Users\Tobias\AppData\Roaming\...</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MyDocuments&nbsp;2,39&nbsp;FileSystem&nbsp;C:\Users\Tobias\Documents</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Personal&nbsp;2,39&nbsp;FileSystem&nbsp;C:\Users\Tobias\Documents</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>(...)</span></span></div></pre><h1 id="5-discovering-file-system-related-cmdlets">5. Discovering File System-related Cmdlets</h1>
<p>Here’s a simple line that returns all file system-related cmdlets:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Command</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Noun&nbsp;item</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;path</span></span></div></pre>
<p>Many of these cmdlets have historic aliases that will help you guess what they are doing:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Alias</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Definition&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span><span>-</span></span><span>item</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span><span>-</span></span><span>path</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Select-Object</span></span><span>&nbsp;Name</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Definition&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Out-GridView</span></span></span></div></pre>
<h1 id="6-clean-your-temp-folder-with-powershell">6. Clean Your Temp Folder with PowerShell</h1>
<p>When disk space gets low, you may want to clean up your temporary folder. The code deletes all files that are older than 30 days to make
sure you’re not dumping anything that’s still needed:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>cutoff</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Date</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-TimeSpan</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Days&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>30</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>before</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>temp</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;Length&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Sum</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.Sum</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>temp</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Length</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-ne</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.LastWriteTime</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-lt</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>cutoff</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;simulation&nbsp;only,&nbsp;no&nbsp;files&nbsp;and&nbsp;folders&nbsp;will&nbsp;be&nbsp;deleted</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;replace&nbsp;-WhatIf&nbsp;with&nbsp;-Confirm&nbsp;to&nbsp;confirm&nbsp;each&nbsp;delete</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;remove&nbsp;-WhatIf&nbsp;altogether&nbsp;to&nbsp;delete&nbsp;without&nbsp;confirmation&nbsp;(at&nbsp;your&nbsp;own&nbsp;risk)</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Remove-Item</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ErrorAction&nbsp;SilentlyContinue&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>WhatIf</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>after</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>temp</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;Length&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Sum</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.Sum</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>freed</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>before</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>after</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>‘Cleanup&nbsp;freed&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>:</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0.0</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;MB.’&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>freed</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>MB</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<p>Since deleting stuff is always risky, we left a -WhatIf in the code so you can check that you are actually deleting your temp folder and
not anything else (due to a typo for example). Once you are comfortable, remove -WhatIf to invoke the cleanup process automatically, or
replace -WhatIf by -Confirm to confirm each delete manually.
You may be surprised how much garbage can be removed.</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PS&gt;&nbsp;C:\Users\Tobias\Documents\temp\Untitled2.ps1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span class="syntax--storage syntax--type syntax--class syntax--warning"><span>WARNING</span></span><span>:&nbsp;Size&nbsp;of&nbsp;</span><span class="syntax--storage syntax--type syntax--class syntax--temp"><span>TEMP</span></span><span>&nbsp;folder&nbsp;is&nbsp;currently&nbsp;879,02&nbsp;MB</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span class="syntax--storage syntax--type syntax--class syntax--warning"><span>WARNING</span></span><span>:&nbsp;Freed&nbsp;329,27&nbsp;MB&nbsp;disk&nbsp;space</span></span></div></pre><h1 id="7-unblocking-and-unpacking-zip-files">7. Unblocking and Unpacking ZIP Files</h1>
<p>Before you can unpack ZIP files downloaded from the Internet, you will want to unblock them - or else executable files like <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.exe</code> or <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.dll</code>
will not work. Here is a script that uses PowerShell 3.0’s new Unblock-File cmdlet to first unblock a ZIP file, then uses the File Explorer integrated
ZIP functionality to unpack its contents:
Note that this requires the built-in Windows ZIP support to be present and not replaced with other ZIP tools.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Source</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;‘c:\some\zipfile.zip’</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Destination</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;‘c:\unpackfolder’&nbsp;</span><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;this&nbsp;folder&nbsp;MUST&nbsp;exist</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Unblock-File</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Destination</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;use&nbsp;this&nbsp;in&nbsp;PowerShell&nbsp;3.0&nbsp;to&nbsp;unblock&nbsp;downloaded&nbsp;data</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;remove&nbsp;this&nbsp;in&nbsp;PowerShell&nbsp;2.0&nbsp;and&nbsp;unblock&nbsp;manually&nbsp;if&nbsp;needed</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>helper</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ComObject&nbsp;Shell.Application</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>files</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>helper</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.NameSpace</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Source</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.Items</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>helper</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.NameSpace</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Destination</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.CopyHere</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>files</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<h1 id="8-find-open-files">8. Find Open Files</h1>
<p>To find open files on a remote system, use openfiles.exe and convert the results to rich objects. Here is a sample (replace “storage1” with
the name of a remote computer you have access permissions):</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;openfiles&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>Query&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>S&nbsp;storage1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>FO&nbsp;CSV&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>V&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ConvertFrom-Csv</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Out-GridView</span></span></span></div></pre>
<p>Openfiles.exe cannot find open files on the local machine (unless you configure your local machine to monitor open files).</p>
<h1 id="9-finding-newest-or-oldest-files">9. Finding Newest or Oldest Files</h1>
<p>In PowerShell 3.0, Measure-Object can be applied not just to numeric data but to anything that is comparable. In PowerShell 2.0, this line
would return the smallest and largest file size in your Windows folder:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Length&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Minimum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Maximum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Select-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Minimum</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>Maximum</span></span></div></pre>
<p>In PowerShell 3.0, you could also measure properties like LastWriteTime, telling you the oldest and newest dates:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;LastWriteTime&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Minimum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Maximum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Select-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Minimum</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>Maximum</span></span></div></pre>
<p>Or, you could get the minimum and maximum start times of all the running processes. Make sure you use Where-Object to exclude any
process that has no StartTime value:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Process</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;StartTime&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;StartTime&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Minimum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Maximum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Select-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Minimum</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>Maximum</span></span></div></pre>
<h1 id="10-finding-duplicate-files">10. Finding Duplicate Files</h1>
<p>Hash tables are a great way to find duplicates. Simply use the hash table as lookup to see if the file (or element) was already added to the
hash table. The following script would find all files and folder with same name in the current folder, the Windows folder and its System32
subfolder.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Find-DuplicateName</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Input</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>lookup</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.ContainsKey</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Name</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‘</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;already&nbsp;exists&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>in</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>.’&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Name</span></span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FullName</span></span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>lookup</span></span><span>.</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Name</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>lookup</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Add</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Name</span></span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FullName</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>lookup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--hashtable syntax--powershell"><span class="syntax--keyword syntax--other syntax--hashtable syntax--begin syntax--powershell"><span>@</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--variable syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>home</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Find-DuplicateName</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Find-DuplicateName</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>\system32&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Find-DuplicateName</span></span></span></div></pre>
<h1 id="11-finding-old-files">11. Finding Old Files</h1>
<p>Occasionally, you might want to find files that are older than a give number of days to delete or backup those. A simple filter can provide
that functionality:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Filter</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Filter-Age</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Days</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>30</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.CreationTime</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-le</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Date</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.AddDays</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>days</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>-1</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Pipe the result of a Dir into the Filter-Age filter, and it will only let those files and folders pass that are at least the specified number of days
old. The following line finds all logfiles in your Windows folder that are at least 10 days old:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>Dir&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.log&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;Filter</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Age&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Days&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>10</span></span></span></div></pre>
<p>You could easily delete or backup the resulting files. This would delete them:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>Dir&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.log&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;Filter</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Age&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Days&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>10</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;Del&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>WhatIf</span></span></div></pre>
<h1 id="12-finding-system-folders">12. Finding System Folders</h1>
<p>You may want to know where special folders such as MyPictures or Documents are located. The Environment .NET class provides a static
method named GetFolderPath() which provides this information. To find the location of your desktop, for example, use this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Environment</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFolderPath</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘Desktop’</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<p>Simply specify an invalid keyword, and the exception will list all valid keywords:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Environment</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFolderPath</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘give&nbsp;me&nbsp;more</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>’</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Cannot&nbsp;convert&nbsp;argument&nbsp;“folder”</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;with&nbsp;value:&nbsp;“give&nbsp;me&nbsp;more</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>”</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>for</span></span><span>&nbsp;“GetFolderPath”&nbsp;to&nbsp;type&nbsp;“System.</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Environment</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>SpecialFolder”:&nbsp;“Cannot&nbsp;convert&nbsp;value</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>“give&nbsp;me&nbsp;more</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>”&nbsp;to&nbsp;type&nbsp;“System.Environment</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>SpecialFolder”</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;Error:&nbsp;“Unable&nbsp;to&nbsp;match&nbsp;the&nbsp;identifier</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>name&nbsp;give&nbsp;me&nbsp;more</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>&nbsp;to&nbsp;a&nbsp;valid&nbsp;enumerator&nbsp;name.</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Specify&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;enumerator&nbsp;names&nbsp;and&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>try</span></span><span>&nbsp;again:&nbsp;Desktop</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Programs</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;MyDocuments</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Personal</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Favorites</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Startup</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Recent</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;SendTo</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;StartMenu</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>MyMusic</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;MyVideos</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;DesktopDirectory</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;MyComputer</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;NetworkShortcuts</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Fonts</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Templates</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>CommonStartMenu</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonPrograms</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonStartup</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>CommonDesktopDirectory</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;ApplicationData</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;PrinterShortcuts</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;LocalApplicationData</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;InternetCache</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Cookies</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;History</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonApplicationData</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Windows</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>System</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;ProgramFiles</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;MyPictures</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;UserProfile</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;SystemX86</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;ProgramFilesX86</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonProgramFiles</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>CommonProgramFilesX86</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonTemplates</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>CommonDocuments</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonAdminTools</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;AdminTools</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonMusic</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonPictures</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonVideos</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;Resources</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>LocalizedResources</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CommonOemLinks</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;CDBurning””</span></span></div></pre>
<h1 id="13-hiding-drive-letters">13. Hiding Drive Letters</h1>
<p>Sometimes you may want to hide drive letters in Explorer from users. There’s a Registry key that can do this for you. It takes a bit mask
where each drive has a bit. When the bit is set, the drive is hidden. Here’s the function that automatically manages the bitmasks and
registry entries to hide selected drive letters:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Hide-Drive</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>DriveLetter</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>key</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--hashtable syntax--powershell"><span class="syntax--keyword syntax--other syntax--hashtable syntax--begin syntax--powershell"><span>@</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--hashtable syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--hashtable syntax--assignment syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>Path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--hashtable syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--hashtable syntax--assignment syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>Name</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>NoDrives</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--hashtable syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>DriveLetter</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Remove-ItemProperty</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>@</span></span><span>key</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>mask</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>DriveLetter</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.toUpper</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Sort-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>mask</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Math</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::Pow</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Byte</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>-65</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Set-ItemProperty</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>@</span></span><span>key</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Value&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>mask</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>type&nbsp;DWORD</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>For example, to hide drives A, B, E, and Z, you would use it like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Hide-Drive</span></span><span>&nbsp;A</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>B</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>E</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>Z</span></span></div></pre>
<p>To display all drives, call Hide-Drive without any argument:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Hide-Drive</span></span></span></div></pre>
<blockquote>
<p>Note that you need to have administrative privileges to change policies, and that policies may be overridden by group policy settings set
up by your corporate IT.
For the changes to take effect, you need to log off and on again or kill your explorer.exe and restart it.</p>
</blockquote>
<h1 id="14-checking-total-size-of-downloads-folder">14. Checking Total Size of Downloads-Folder</h1>
<p>Whenever you download something with IE, by default the files get stored in your personal download folder. Often, over time a lot of
garbage can accumulate. This line tells you just how much data you store in this folder:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>folder</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>userprofile</span></span><span>\Downloads</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>folder</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Length&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Sum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>sum</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Sum</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>MB</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Your&nbsp;Downloads&nbsp;folder&nbsp;currently&nbsp;occupies&nbsp;{0:#,##0.0}&nbsp;MB&nbsp;storage</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>sum</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>You may be surprised just how much stuff has been collected there.</p>
<h1 id="15-sharing-folders">15. Sharing Folders</h1>
<p>Console commands are first class PowerShell citizens, so sometimes it may be easier to use classic console commands to solve a
problem. Here is a function that creates a local folder and also shares it so others can use it via network. Just be aware that the net.exe
used to share the folder requires you to have full admin privileges:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>New-Share</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Name</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>try</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>ErrorActionPreference</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;’Stop’</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>false</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Item</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ItemType&nbsp;Directory</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>net.exe</span></span><span>&nbsp;share&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Name</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>catch</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Write-Warning</span></span><span>&nbsp;”Create&nbsp;Share:&nbsp;Failed</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span><span>”</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>And this is how you share new folders:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Share</span></span><span>&nbsp;c:\myfolder&nbsp;sharedplace</span></span></div></pre>
<p>sharedplace was shared successfully.</p>
<h1 id="16-shrinking-paths">16. Shrinking Paths</h1>
<p>Many file-related .NET Framework methods fail when the overall path length exceeds a certain length. Use low-level methods to convert
lengthy paths to the old 8.3 notation which is a lot shorter in many cases:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-ShortPath</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--attribute syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--support syntax--function syntax--attribute syntax--powershell"><span>Parameter</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--attribute syntax--powershell"><span>Mandatory</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>true</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>code</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;@</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>[DllImport(“kernel32.dll”,&nbsp;CharSet&nbsp;=&nbsp;CharSet.Auto,&nbsp;SetLastError=true)]</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span>&nbsp;&nbsp;public&nbsp;static&nbsp;extern&nbsp;uint&nbsp;GetShortPathName(string&nbsp;longPath,</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span>&nbsp;&nbsp;StringBuildershortPath,uint&nbsp;bufferSize);</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>@</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>API</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Add-Type</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>MemberDefinition&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>code</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;Path&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>UsingNamespace&nbsp;System.Text&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>PassThru</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortBuffer</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;Text.StringBuilder&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Length</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>rv</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>API</span></span><span>::GetShortPathName</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortBuffer</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortBuffer</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Capacity</span></span></span><span>&nbsp;</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>rv</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-ne</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortBuffer</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.ToString</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Write-Warning</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Path&nbsp;'</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>'&nbsp;not&nbsp;found.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Here is how you can use the new function:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;md&nbsp;c:\thisIsALongName\VeryLongPath\MayExceed260chars&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ShortPath</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>c:\thisIsALongName\VeryLongPath\MayExceed260chars</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>c:\THISIS~</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span>\VERYLO~</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span>\MAYEXC~</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span></span></div></pre>
<h1 id="17-how-large-are-my-folders-">17. How Large Are My Folders?</h1>
<p>To find out the total size of all subfolders in a directory, try this function:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-FolderSize</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--support syntax--constant syntax--variable syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>home</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>code</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>:</span><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>,##0.0}&nbsp;MB’&nbsp;-f&nbsp;($this/1MB))&nbsp;}</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>Path</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.PSIsContainer</span></span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Write-Progress</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Activity&nbsp;’Calculating&nbsp;Total&nbsp;Size&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>for</span></span><span>:’&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Status&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FullName</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>sum</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FullName</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ErrorAction&nbsp;SilentlyContinue&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Measure-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Length&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Sum&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ErrorAction&nbsp;SilentlyContinue</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>sum</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Sum</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Select-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;Path</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;TotalSize</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Path</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FullName</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.TotalSize</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Add-Member</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>MemberType&nbsp;ScriptMethod&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;toString&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Value&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>code</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>PassThru</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></div></pre>
<p>And this is what a result would typically look like:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-FolderSize</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Path&nbsp;TotalSize</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\addins&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\AppCompat&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\apppatch&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>11</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>8</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\assembly&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2.279</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>4</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\AUInstallAgent&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\Boot&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>36</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>8</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\Branding&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\BrowserChoice&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span>&nbsp;MB</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>...</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<h1 id="18-bulk-renaming-files">18. Bulk-Renaming Files</h1>
<p>Rename-Item can rename hundreds of files in one step. Have a look:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--storage syntax--modifier syntax--scope syntax--powershell"><span>global</span></span><span>:i</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;c:\test1\&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.jpg&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Rename-Item</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>NewName&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;“picture_</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>i</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.jpg</span></span></span><span>”</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--powershell"><span>;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--storage syntax--modifier syntax--scope syntax--powershell"><span>global</span></span><span>:i</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span><span>+</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>This code assumes there is a folder called <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">c:\test1</code> that contains a number of <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.jpg</code> files. Get-ChildItem gets all the <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.jpg</code>
files and pipes them to Rename-Item. Rename-Item then renames all of these files as “picture_X.jpg” where X is an incrementing
number.</p>
<h1 id="19-monitoring-folder-content">19. Monitoring Folder Content</h1>
<p>You can use a FileSystemWatcher object to monitor a folder and write a log for all newly created files. Here is a script that demonstrates
this.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;make&nbsp;sure&nbsp;this&nbsp;folder&nbsp;exists.&nbsp;Script&nbsp;will&nbsp;monitor&nbsp;changes&nbsp;to&nbsp;this&nbsp;folder:</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>folder</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;’C:\SomeFolder’</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>timeout</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1000</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>FileSystemWatcher</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;System.IO.FileSystemWatcher&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>folder</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Write-Host</span></span><span>&nbsp;”Press&nbsp;CTRL</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>C&nbsp;to&nbsp;abort&nbsp;monitoring&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>folder</span></span><span>”</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>while</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>true</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>FileSystemWatcher</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.WaitForChanged</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘all’</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>timeout</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.TimedOut</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>false</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Write-Warning</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘File&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;:&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>’&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.ChangeType</span></span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>result</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.name</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Write-Host</span></span><span>&nbsp;’Monitoring&nbsp;aborted.’</span></span></div></pre>
<p>It monitors the folder <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">c:\somefolder</code> (which you should create before you run this script). Next, while the script is running, any change to
the folder is reported. For example, if you open the monitored folder in Windows Explorer, add a new text file, rename it and then delete it,
here’s the result:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;C:\testscript.ps1</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Press&nbsp;CTRL</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>C&nbsp;to&nbsp;abort&nbsp;monitoring&nbsp;C:\Users\Tobias</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>WARNING:&nbsp;File&nbsp;Created&nbsp;:&nbsp;New&nbsp;Text&nbsp;Document.txt</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>WARNING:&nbsp;File&nbsp;Renamed&nbsp;:&nbsp;test.txt</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>WARNING:&nbsp;File&nbsp;Deleted&nbsp;:&nbsp;test.txt</span></span></div></pre>
<h1 id="20-open-file-exclusively">20. Open File Exclusively</h1>
<p>To open a file in a locked state so no one else can open, access, read, or write the file, you can use the low-level .NET methods like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;”</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>temp</span></span><span>\somefile.txt”&nbsp;</span><span class="syntax--comment syntax--line syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>#</span></span><span>&nbsp;MUST&nbsp;EXIST!</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--powershell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>false</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Set-Content</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Value’test’</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.io.File</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::Open</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;’Open’</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;’Read’</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;’None’</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>reader</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;System.IO.StreamReader</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>text</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>reader</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.ReadToEnd</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>reader</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Close</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Read-Host</span></span><span>&nbsp;’Press&nbsp;ENTER&nbsp;to&nbsp;release&nbsp;file</span><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span>’</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Close</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<p>This will lock a file and read its content. To illustrate the lock, the file will remain locked until you press ENTER.</p>
<h1 id="21-removing-file-extensions">21. Removing File Extensions</h1>
<p>To remove file extensions, use .NET methods:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>system.io.path</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFileNameWithoutExtension</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>c:\test\report.txt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<h1 id="22-quickly-changing-file-extensions">22. Quickly Changing File Extensions</h1>
<p>If you want to quickly exchange a file extension to create a “bak” backup version or generate a new file name for output, you should use
the ChangeExtension() method:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>oldpath</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>c:\test\datei.csv</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>newpath</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.IO.Path</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::ChangeExtension</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>oldpath</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>.xls</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>oldpath</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>newpath</span></span></span></div></pre>
<h1 id="23-grouping-files-based-on-size">23. Grouping Files Based on Size</h1>
<p>Group-Object can auto-create hash tables so that you can easily create groups of objects of a kind.
Here is an example:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>criteria</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Length</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-lt</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>KB</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>tiny</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>elseif</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.length</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-lt</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>MB</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>average</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>huge</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>myFiles</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;dir&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Group-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>criteria</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>asHash&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>asString</span></span></div></pre>
<p>Next, you can output the results, or use your keywords to access the file groups:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>myFiles</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Name&nbsp;Value</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>huge&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--support syntax--function syntax--powershell"><span>explorer.exe</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;WindowsUpdate.log</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>tiny&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>addins</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;AppCompat</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;AppPatch</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;assembly...</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>average&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span class="syntax--support syntax--function syntax--powershell"><span>bfsvc.exe</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;bootstat.dat</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;ColorPicker&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>for</span></span><span>&nbsp;PowerPoint&nbsp;Setup&nbsp;Log.txt</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>DPINST.LOG...</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>myFiles</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.huge</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Directory:&nbsp;C:\Windows</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Mode&nbsp;LastWriteTime&nbsp;Length&nbsp;Name</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span><span>-</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>a</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>25.02</span></span><span>.</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2011</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>07</span></span><span>:</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>19</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2871808</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>explorer.exe</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>a</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span><span>-</span><span>-</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>20.02</span></span><span>.</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2013</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>13</span></span><span>:</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>21</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1975208</span></span><span>&nbsp;WindowsUpdate.log</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span></span></div></pre>
<h1 id="24-open-many-files-with-one-command">24. Open Many Files with One Command</h1>
<p>To quickly open all files of a kind, such as all text or script files found in a folder, you should try the Open-File function. It will accept a
simple pattern, such as <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.txt</code> which opens all text files, or a*.ps1 which opens all PowerShell scripts that start with “a”:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Open-file</span></span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--attribute syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--support syntax--function syntax--attribute syntax--powershell"><span>Parameter</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--attribute syntax--powershell"><span>Mandatory</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>true</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>paths</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Resolve-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;SilentlyContinue</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>paths</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-ne</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>null</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>paths</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Foreach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Invoke-Item</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>“No&nbsp;file&nbsp;matched&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>.”</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>The next command then would open all text files in your current folder with the program that is associated with .txt-files (like Notepad editor):</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS&nbsp;</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Open-File</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.txt</span></span></div></pre>
<h1 id="25-use-multiple-wildcards">25. Use Multiple Wildcards</h1>
<p>Did you know that you can use multiple wildcards in paths? This will give you a lot of control.
This line will find all DLL files in all subfolders up to two levels below your Windows folder (it will take a couple of seconds for Resolve-Path
to gather all files):</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Resolve-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.dll&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span></div></pre>
<p>And this line will lists the Desktop folder content for all user accounts on your computer—provided that you have sufficient privileges:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>dir&nbsp;c:\users\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>\desktop\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span></span></div></pre>
<h1 id="26-filtering-multiple-file-types">26. Filtering Multiple File Types</h1>
<p>If you want to filter files based on multiple extensions, you can use this filter:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Filter</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Where-Extension</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>String</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span><span>]</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>extension</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>‘.bmp’</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;’.jpg’</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;’.wmv’</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>extension</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-contains</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Extension</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>To find all <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.log-files</code> and all <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">*.txt-files</code> in your Windows folder, use it like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>dir&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ea&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Where</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Extension&nbsp;.log</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>.txt</span></span></div></pre>
<h1 id="27-creating-shortcuts-on-your-desktop">27. Creating Shortcuts on your Desktop</h1>
<p>PowerShell and .NET can do amazing things, but they are not good at creating shortcuts. However, you can create a shortcut on your
Desktop with just a few lines of code using COM objects instead:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shell</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ComObject&nbsp;WScript.Shell</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>desktop</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.Environment</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFolderPath</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>Desktop</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortcut</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shell</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.CreateShortcut</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>desktop</span></span><span>\clickme.lnk</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortcut</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.TargetPath</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>notepad.exe</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortcut</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.IconLocation</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>shell32.dll,23</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>shortcut</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Save</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<h1 id="28-create-files-and-folders-in-one-step">28. Create Files and Folders in One Step</h1>
<p>Use New-Item like this when you want to create a file plus all the folders necessary to host the file:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Item</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;c:\subfolder\anothersubfolder\yetanotherone\test1.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Type&nbsp;File&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force</span></span></div></pre>
<p>This will create the necessary folders first and then insert a blank file into the last folder. You can then edit the file easily using Notepad.
The magic is done by -Force, but this parameter will also overwrite the file if it already exists. You may want to use Test-Path first to check whether the file exists if you must make sure it won’t get overwritten.</p>
<h1 id="29-remove-recents-folder">29. Remove Recents Folder</h1>
<p>Windows uses the special recent folder to remember which files you have opened. You can have a look at the information Windows has
accumulated. Remove the -WhatIf parameter if you want to get rid of the files:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Environment</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetFolderPath</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Recent</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Remove-Item</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recurse&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>WhatIf</span></span></div></pre>
<h1 id="30-displaying-hex-dumps">30. Displaying Hex Dumps</h1>
<p>PowerShell can read plain text, but it can also read binary content. Here is a little function that creates a “hex dump” of any binary file:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-HexDump</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>width</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>10</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>-1</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--language syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>OFS</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-Content</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Encoding&nbsp;byte&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ReadCount&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>width</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>TotalCount&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>bytes</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>byte</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>byte</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.count&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-ne</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>width</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>byte</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>{0:x}</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.PadLeft</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>0</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>char</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>byte</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>char</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::IsLetterOrDigit</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>char</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>char</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>And this is an example on how to call the function:</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PS&gt;&nbsp;Get-HexDump&nbsp;$env:windir\explorer.exe&nbsp;-width&nbsp;15&nbsp;-bytes&nbsp;150</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>4d&nbsp;5a&nbsp;90&nbsp;00&nbsp;03&nbsp;00&nbsp;00&nbsp;00&nbsp;04&nbsp;00&nbsp;00&nbsp;00&nbsp;ffff&nbsp;00&nbsp;MZ..........ÿÿ.</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>00&nbsp;b8&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;40&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;...............</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>e0&nbsp;00&nbsp;00&nbsp;00&nbsp;0e&nbsp;1f&nbsp;ba&nbsp;0e&nbsp;00&nbsp;b4&nbsp;09&nbsp;cd&nbsp;21&nbsp;b8&nbsp;01&nbsp;à.....º....Í...</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>4c&nbsp;cd&nbsp;21&nbsp;54&nbsp;68&nbsp;69&nbsp;73&nbsp;20&nbsp;70&nbsp;72&nbsp;6f&nbsp;67&nbsp;72&nbsp;61&nbsp;6d&nbsp;LÍ.This.program</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>20&nbsp;63&nbsp;61&nbsp;6e&nbsp;6e&nbsp;6f&nbsp;74&nbsp;20&nbsp;62&nbsp;65&nbsp;20&nbsp;72&nbsp;75&nbsp;6e&nbsp;20&nbsp;.cannot.be.run.</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>69&nbsp;6e&nbsp;20&nbsp;44&nbsp;4f&nbsp;53&nbsp;20&nbsp;6d&nbsp;6f&nbsp;64&nbsp;65&nbsp;2e&nbsp;0d&nbsp;0d&nbsp;0a&nbsp;in.DOS.mode....</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>24&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;93&nbsp;83&nbsp;28&nbsp;37&nbsp;d7&nbsp;e2&nbsp;46&nbsp;...........7.âF</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>64&nbsp;d7&nbsp;e2&nbsp;46&nbsp;64&nbsp;d7&nbsp;e2&nbsp;46&nbsp;64&nbsp;de&nbsp;9a&nbsp;c2&nbsp;64&nbsp;9d&nbsp;e2&nbsp;d.âFd.âFdÞ.Âd.â</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PS&gt;</span></span></div></pre><h1 id="31-reading-file-magic-number-">31. Reading File “Magic Number”</h1>
<p>File types are not entirely dependent on file extension. Rather, binary files have internal ID numbers called “magic numbers” that tell
Windows what type of file it is. Here is a function to read and display the magic number:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-MagicNumber</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Resolve-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-Content</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Encoding&nbsp;byte&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ReadCount&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>4</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>TotalCount&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>4</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex1</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>{0:x}</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>256</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.PadLeft</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>4</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>0</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex2</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>{0:x}</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>256</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>3</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.PadLeft</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>4</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>0</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>string</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>chars</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>magicnumber</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span class="syntax--support syntax--function syntax--powershell"><span>ForEach-Object</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>char</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::IsLetterOrDigit</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>char</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>{0}&nbsp;{1}&nbsp;'{2}'</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex1</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>hex2</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>chars</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Executable files use the two letters “MZ” (which coincidentally are the initials of Mark Zbikowski, one of the original developers of MS
DOS). Data files use different signatures.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-MagicNumber</span></span><span>&nbsp;C:\Windows\</span><span class="syntax--support syntax--function syntax--powershell"><span>explorer.exe</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>4d5a&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>9000</span></span><span>&nbsp;‘M&nbsp;Z&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;.’</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-MagicNumber</span></span><span>&nbsp;C:\Windows\bootstat.dat</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>2000</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>0000</span></span><span>&nbsp;‘</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;.’</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-MagicNumber</span></span><span>&nbsp;C:\Windows\</span><span class="syntax--support syntax--function syntax--powershell"><span>notepad.exe</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>4d5a&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>9000</span></span><span>&nbsp;‘M&nbsp;Z&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>.</span></span><span>&nbsp;.’</span></span></div></pre>
<h1 id="32-rename-drive-label">32. Rename Drive Label</h1>
<p>WMI can read any drive label (the name that appears next to a drive inside Explorer), and you can change the drive label, too—provided
you have administrator privileges. This code renames drive c:\ to “My Harddrive”:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>wmi</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>”Win32_LogicalDisk</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>’C:’”</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.VolumeName</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;”My&nbsp;Harddrive”</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Put</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div></pre>
<p>Just make sure to call Put() so your changes will get written back to the original object.</p>
<h1 id="33-no-need-for-virtual-drives">33. No Need for Virtual Drives</h1>
<p>You do not need to use drive letters to access information provided by PowerShell providers. For example, use this to list the HKEY_
CLASSES_ROOT in your Registry:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>Dir&nbsp;Registry::HKEY_CLASSES_ROOT</span></span></div></pre>
<p>By pre-pending the path with the provider name that PowerShell should use, you no longer need drive letters. This is basically the same as adding a new virtual drive and specifying the provider PowerShell should use:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-PSDrive</span></span><span>&nbsp;HKCR&nbsp;Registry&nbsp;HKEY_CLASSES_ROOT</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Dir&nbsp;HKCR:</span></span></div></pre>
<h1 id="34-temporary-file-name">34. Temporary File Name</h1>
<p>Thanks to Get-Date, you can easily create unique temporary file names with a timestamp:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Date</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>format&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>yyyy-MM-ddhh-mm-ss</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>+</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>.tmp</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div></pre>
<h1 id="35-creating-large-dummy-files-with-net">35. Creating Large Dummy Files with .NET</h1>
<p>If you need to create large dummy files, the following code is a very fast way to generate really large test files. This for example creates a 1GB file in a fraction of a second:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>temp</span></span><span>\testfile.txt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>io.file</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::Create</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.SetLength</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>gb</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Close</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-Item</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>path</span></span></span></div></pre>
<h1 id="36-does-a-folder-contain-a-specific-file-">36. Does a Folder Contain a Specific File?</h1>
<p>Test-Path supports wildcards so if you’d like to know whether there are any PowerShell script files located in your home folder, try this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--variable syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>home</span></span><span>\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.ps1</span></span></div></pre>
<p>To get the actual number of PowerShell scripts, use Get-Childitem and count the result:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--group syntax--array-expression syntax--powershell"><span class="syntax--keyword syntax--other syntax--array syntax--begin syntax--powershell"><span>@</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--variable syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>home</span></span><span>\</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>.ps1</span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span>.Count</span></span></div></pre>
<p>Note the @() converts any result into an array so even if there is only one file or none, the result will be an array so you can safely query its Count property. This step isn’t necessary anymore in PowerShell 3.0, but it won’t do any harm there and keeps your code compatible.</p>
<h1 id="37-file-or-folder-find-out-">37. File or Folder? Find Out!</h1>
<p>Test-Path can check whether a file or folder exists, but this does not tell you whether the path specified was actually a file or a folder. If you’d like to check whether the folder c:\test exists, use this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;c:\test&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>PathType&nbsp;Container</span></span></div></pre>
<p>If c:\test was a file (without extension), Test-Path would still return false because with the -PathType parameter, you explicitly looked for
folders. Likewise, if you want to explicitly check for files, use the parameter -PathType leaf.</p>
<h1 id="38-list-hidden-files">38. List Hidden Files</h1>
<p>Did you notice that Dir, ls or Get-ChildItem do not return hidden files?
To see hidden files, you need to specify the -Force parameter:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force</span></span></div></pre>
<p>But what if you just wanted to see hidden files only? Filter the result, for example like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Where-Object</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span><span>&nbsp;</span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>_</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Mode</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-like</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>*h*</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>In PowerShell 3.0, you can also use:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ChildItem</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Attributes&nbsp;h</span></span></div></pre>
<h1 id="39-converting-file-system-to-ntfs">39. Converting File System to NTFS</h1>
<p>You probably know about the convert.exe utility which can convert a file system to NTFS without data loss. This tool cannot be run automatically though because it wants a manual confirmation and asks for the drive label of the drive you want to convert.
Here is an example how PowerShell can embrace convert.exe and turn it into a more sophisticated tool that converts drives without manual confirmation. Of course, this imposes risk because converting a file system cannot be undone.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>ConvertTo-NTFS</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>C:</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Throw</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Drive&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>&nbsp;does&nbsp;not&nbsp;exist.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>wmi</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Win32_LogicalDisk='</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>'</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>label</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.VolumeName</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>filesystem</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.FileSystem</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>filesystem</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>NTFS</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Throw</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>Drive&nbsp;already&nbsp;uses&nbsp;NTFS&nbsp;filesystem</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Label&nbsp;is&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>label</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>label</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>convert.exe</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>FS:NTFS&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>/</span></span><span>X</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Make sure the drive you want to convert is not in use or else the conversion may be scheduled to take place at next reboot.</p>
<h1 id="40-reading-and-writing-drive-labels">40. Reading and Writing Drive Labels</h1>
<p>Drive labels are the names attached to logical disks. Using WMI, you can both read and write (change) drive labels.
To read the existing drive label, use this function:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-DriveLabel</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>C:</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Throw</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Drive&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>&nbsp;does&nbsp;not&nbsp;exist.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>wmi</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Win32_LogicalDisk='</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>'</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.VolumeName</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-DriveLabel</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>BOOTCAMP</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span></span></div></pre>
<p>To actually change the drive label, try this one:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Set-DriveLabel</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>C:</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>label</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>New&nbsp;Label</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Throw</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Drive&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>&nbsp;does&nbsp;not&nbsp;exist.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>instance</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>wmi</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Win32_LogicalDisk='</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>'</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>instance</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.VolumeName</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>label</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>instance</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.Put</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>So to set a new drive label for disk D:, use this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Set-DriveLabel</span></span><span>&nbsp;D:&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>A&nbsp;new&nbsp;label</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div></pre>
<p>Be aware that changing a drive label requires Admin privileges.</p>
<h1 id="41-determining-a-drives-file-system">41. Determining a Drives’ File System</h1>
<p>If you ever needed a tool to find out the type of file system for any drive, take a look at this simple PowerShell function:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--function syntax--powershell"><span class="syntax--storage syntax--type syntax--powershell"><span>Function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--powershell"><span>Get-FileSystem</span></span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>param</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>C:</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--unary syntax--powershell"><span>!</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Test-Path</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--begin syntax--powershell"><span>{</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>Throw</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Drive&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>&nbsp;does&nbsp;not&nbsp;exist.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>wmi</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>"</span></span><span>Win32_LogicalDisk='</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>letter</span></span><span>'</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>"</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span><span>.FileSystem</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--meta syntax--scriptblock syntax--powershell"><span class="syntax--punctuation syntax--section syntax--braces syntax--end syntax--powershell"><span>}</span></span></span></span></div></pre>
<p>Get-FileSystem accepts a drive letter such as “D:”, defaults to drive “C:” otherwise, and returns the file system used by that drive.</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-FileSystem</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>NTFS</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span></span></div></pre>
<h1 id="42-removing-illegal-file-name-characters">42. Removing Illegal File Name Characters</h1>
<p>If you need to batch-process hundreds of file names, you may want to make sure all file names are legal and automatically remove all
illegal characters. Here is how you can check for illegal file names (and optionally remove illegal characters from it):</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>this*file\\is_illegal&lt;&gt;.txt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>pattern</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>[{0}]</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--string-format syntax--powershell"><span>-f</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Regex</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::Escape</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>String</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>System.IO.Path</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::GetInvalidFileNameChars</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>newfile</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--bracket syntax--begin syntax--powershell"><span>[</span></span><span class="syntax--storage syntax--type syntax--powershell"><span>Regex</span></span><span class="syntax--punctuation syntax--section syntax--bracket syntax--end syntax--powershell"><span>]</span></span><span>::Replace</span><span class="syntax--punctuation syntax--section syntax--group syntax--begin syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>file</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>pattern</span></span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span><span class="syntax--punctuation syntax--section syntax--group syntax--end syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>newfile</span></span></span></div></pre>
<h1 id="43-using-simple-path-analysis">43. Using Simple Path Analysis</h1>
<p>PowerShell comes with the Split-Path cmdlet, which helps you disassemble paths and find the interesting information. Take a look:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>IsAbsolute</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Leaf</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>NoQualifier</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Parent</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Split-Path</span></span><span>&nbsp;c:\test\file.txt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Qualifier</span></span></div></pre>
<h1 id="44-getting-real-paths">44. Getting Real Paths</h1>
<p>PowerShell uses virtual drives, which sometimes have a close mapping to the “real” drives you see in Windows Explorer. However,
sometimes these drives have no apparent real-world relation. Let’s say you have created the following drive “test”:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-PSDrive</span></span><span>&nbsp;test&nbsp;FileSystem&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>dir&nbsp;test:</span></span></div></pre>
<p>The virtual drive “test” now points to your Windows folder. To “translate” virtual paths to real paths, use Convert-Path:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Convert-Path</span></span><span>&nbsp;test:\system32</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>C:\Windows\system32</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span></span></div></pre>
<h1 id="45-select-folder-dialog">45. Select Folder-Dialog</h1>
<p>Want to provide your users with a neat dialog to select folders? Simply use a COM object called Shell.Application, which provides the
BrowseForFolder method:
Function Select-Folder {
param (
$message= 'Select a folder',
$path = 0
)
  $object = New-Object -ComObject Shell.Application
  $folder = $object.BrowseForFolder(0, $message, 0, $path)
  if ($folder -ne $null) {
    $folder.self.Path
  }
}</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Select-Folder</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>Select&nbsp;the&nbsp;folder&nbsp;you&nbsp;want!</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Select-Folder</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>message&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>Select&nbsp;some&nbsp;folder!</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>path</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span class="syntax--support syntax--variable syntax--drive syntax--powershell"><span>env:</span></span><span>windir</span></span></span></div></pre>
<h1 id="46-quick-drive-info">46. Quick Drive Info</h1>
<p>Want to quickly get a number of interesting details for any drive? Use the .NET System.IO.DriveInfo class like this:</p>
<pre class="editor-colors lang-ps1"><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>New-Object</span></span><span>&nbsp;System.io.DriveInfo&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--powershell"><span>'</span></span><span>C:</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--powershell"><span>'</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.DriveFormat</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>NTFS</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span><span class="syntax--variable syntax--other syntax--member syntax--powershell"><span>.VolumeLabel</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>BOOTCAMP</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span class="syntax--punctuation syntax--definition syntax--variable syntax--powershell"><span>$</span></span><span>drive</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>Name&nbsp;:&nbsp;C:\</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>DriveType&nbsp;:&nbsp;Fixed</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>DriveFormat&nbsp;:&nbsp;NTFS</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>IsReady&nbsp;:&nbsp;True</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>AvailableFreeSpace&nbsp;:&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>6212796416</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>TotalFreeSpace&nbsp;:&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>6212796416</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>TotalSize&nbsp;:&nbsp;</span><span class="syntax--constant syntax--numeric syntax--integer syntax--powershell"><span>125139152896</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>RootDirectory&nbsp;:&nbsp;C:\</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>VolumeLabel&nbsp;:&nbsp;BOOTCAMP</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>PS</span><span class="syntax--keyword syntax--operator syntax--redirection syntax--powershell"><span>&gt;</span></span></span></div></pre></body>
</html>
