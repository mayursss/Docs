<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>PowerShell_AD_Commands</title>
      <link rel="stylesheet" href="styles.css">
  </head>
  <body class='markdown-preview' data-use-github-style><h1 id="usefull-powershell-ad-commands-with-examples">Usefull PowerShell AD Commands with Examples</h1>
<h2 id="1-get-aduser"><strong>1.</strong> Get-ADUser</h2>
<ul>
<li><p>To get all properties names of AD user account "<code>user1</code>"</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;user1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.PropertyNames</span></span></span></div></pre>
<p>Output</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountExpirationDate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>accountExpires</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountLockoutTime</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountNotDelegated</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AllowReversiblePasswordEncryption</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>BadLogonCount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>badPasswordTime</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>badPwdCount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>c</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CannotChangePassword</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CanonicalName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Certificates</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuDtmfId</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuListInUMDirectory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuObjectType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuTransferId</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuUMLocationObjectId</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuUndeletable</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ciscoEcsbuUnityAttributes</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>City</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CN</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CN=INHINAC3,OU=_Assigned_Local_Admin_Rights,OU=Workstations,DC=ap,DC=att,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>co</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>codePage</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Company</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Country</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>countryCode</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Created</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>createTimeStamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Deleted</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Department</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Description</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DisplayName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DistinguishedName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Division</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DoesNotRequirePreAuth</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>dSCorePropagationData</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>EmailAddress</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>EmployeeID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>EmployeeNumber</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Enabled</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute11</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute13</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute15</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute2</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute5</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute6</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute7</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>extensionAttribute9</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Fax</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>garbageCollPeriod</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>GivenName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomeDirectory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomedirRequired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomeDrive</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>homeMDB</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>homeMTA</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomePage</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomePhone</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Initials</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>instanceType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>internetEncoding</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ipPhone</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>isDeleted</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>l</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastBadPasswordAttempt</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastKnownParent</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lastLogoff</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lastLogon</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastLogonDate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lastLogonTimestamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>legacyExchangeDN</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LockedOut</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lockoutTime</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>logonCount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LogonWorkstations</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>mail</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>mailNickname</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>managedObjects</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Manager</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>mDBUseDefaults</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MemberOf</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MNSLogonAccount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>mobile</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MobilePhone</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Modified</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>modifyTimeStamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-Cached-Membership</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-Cached-Membership-Time-Stamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-Site-Affinity</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-User-Account-Control-Computed</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchHideFromAddressLists</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchHomeServerName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMailboxAuditEnable</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMailboxAuditLastAdminAccess</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMailboxAuditLastDelegateAccess</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMailboxGuid</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMailboxSecurityDescriptor</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchMDBRulesQuota</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchOmaAdminWirelessEnable</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchPoliciesIncluded</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchRBACPolicyLink</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchRecipientDisplayType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchRecipientTypeDetails</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchSafeSendersHash</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchTextMessagingState</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchUMDtmfMap</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchUserAccountControl</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchUserCulture</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchVersion</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msExchWhenMailboxCreated</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Name</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>nTSecurityDescriptor</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectCategory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectClass</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectGUID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>objectSid</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Office</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OfficePhone</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Organization</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OtherName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordExpired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordLastSet</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordNeverExpires</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordNotRequired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>physicalDeliveryOfficeName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>POBox</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PostalCode</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PrimaryGroup</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>primaryGroupID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ProfilePath</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ProtectedFromAccidentalDeletion</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>proxyAddresses</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>pwdLastSet</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SamAccountName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>sAMAccountType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ScriptPath</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>sDRightsEffective</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ServicePrincipalNames</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>showInAddressBook</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>showInAdvancedViewOnly</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SIDHistory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SmartcardLogonRequired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>sn</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>st</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>State</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>StreetAddress</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Surname</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>telephoneNumber</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>textEncodedORAddress</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Title</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>TrustedForDelegation</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>TrustedToAuthForDelegation</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>UseDESKeyOnly</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>userAccountControl</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>userCertificate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>UserPrincipalName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>uSNChanged</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>uSNCreated</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>whenChanged</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>whenCreated</span></span></div></pre></li>
<li>To get only specific information for user store output to variable and then access user account attributes, see below example.<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;ms458j&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Now&nbsp;access&nbsp;the&nbsp;specific&nbsp;details&nbsp;as&nbsp;below</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;Expiry&nbsp;Date&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.AccountExpirationDate</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Account&nbsp;Expiry&nbsp;date</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Name&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Name</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;name</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;Enabled?</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Enabled</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Check&nbsp;if&nbsp;account&nbsp;is&nbsp;Enabled&nbsp;or&nbsp;not&nbsp;,&nbsp;it&nbsp;returns&nbsp;True/False</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Name&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.HomeDrive</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;home&nbsp;Drive&nbsp;name</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Home&nbsp;Directory&nbsp;path&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.HomeDirectory</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;home&nbsp;Drive&nbsp;path</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Password&nbsp;last&nbsp;changed&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.PasswordLastSet</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;last&nbsp;password&nbsp;changed&nbsp;date&nbsp;&amp;&nbsp;time.</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Last&nbsp;Logon&nbsp;Date&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.LastLogonDate</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;last&nbsp;logon&nbsp;date&nbsp;&amp;&nbsp;time.</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Display&nbsp;Name&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.DisplayName</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;name</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Email&nbsp;ID&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.EmailAddress</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;email&nbsp;ID</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Full&nbsp;ID&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.UserPrincipalName</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;full&nbsp;login&nbsp;ID</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Failed&nbsp;Logon&nbsp;attempt&nbsp;count&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.BadLogonCount</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;failed&nbsp;login&nbsp;attempt&nbsp;count</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Login&nbsp;ID&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.SamAccountName</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;user&nbsp;login&nbsp;ID</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;Locked&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.LockedOut</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Check&nbsp;account&nbsp;is&nbsp;locked&nbsp;True/False</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;OU&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.DistinguishedName</span></span><span>&nbsp;</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Provide&nbsp;OU&nbsp;info</span></span></span></div></pre>
Output<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;Expiry&nbsp;Date&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;12/31/2021&nbsp;17:00:00</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Name&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;user1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;Enabled?&nbsp;&nbsp;&nbsp;&nbsp;True</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Name&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;H:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Home&nbsp;Directory&nbsp;path&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;\\FPServer01.test.local.com\users\user1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Password&nbsp;last&nbsp;changed&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;03/26/2018&nbsp;08:31:38</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Last&nbsp;Logon&nbsp;Date&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;05/07/2018&nbsp;17:44:11</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Display&nbsp;Name&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;user1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Email&nbsp;ID&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;user1@test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Full&nbsp;ID&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;user1@test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Failed&nbsp;Logon&nbsp;attempt&nbsp;count&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;0</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Login&nbsp;ID&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;user1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;Locked&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;False</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;OU&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;CN=user1,OU=User&nbsp;Accounts,OU=Accounts,DC=ap,DC=att,DC=com</span></span></div></pre></li>
</ul>
<h2 id="2-get-adcomputer">2. Get-ADComputer</h2>
<ul>
<li>To get all properties names of AD computer account "<code>computer1</code>"<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADComputer</span></span><span>&nbsp;computer1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.PropertyNames</span></span></span></div></pre>
Output<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountExpirationDate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>accountExpires</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountLockoutTime</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AccountNotDelegated</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AllowReversiblePasswordEncryption</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>BadLogonCount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CannotChangePassword</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CanonicalName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Certificates</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>CN</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>codePage</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>countryCode</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Created</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>createTimeStamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Deleted</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Description</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DisplayName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DistinguishedName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DNSHostName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DoesNotRequirePreAuth</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>dSCorePropagationData</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Enabled</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomedirRequired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HomePage</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>instanceType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IPv4Address</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IPv6Address</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>isCriticalSystemObject</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>isDeleted</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastBadPasswordAttempt</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastKnownParent</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lastLogon</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastLogonDate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>lastLogonTimestamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>localPolicyFlags</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Location</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LockedOut</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>logonCount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ManagedBy</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MemberOf</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>MNSLogonAccount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Modified</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>modifyTimeStamp</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-SupportedEncryptionTypes</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>msDS-User-Account-Control-Computed</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Name</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>nTSecurityDescriptor</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectCategory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectClass</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectGUID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>objectSid</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystem</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemHotfix</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemServicePack</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemVersion</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordExpired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordLastSet</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordNeverExpires</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PasswordNotRequired</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PrimaryGroup</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>primaryGroupID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ProtectedFromAccidentalDeletion</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>pwdLastSet</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SamAccountName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>sAMAccountType</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>sDRightsEffective</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ServiceAccount</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>servicePrincipalName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ServicePrincipalNames</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SID</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SIDHistory</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>TrustedForDelegation</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>TrustedToAuthForDelegation</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>UseDESKeyOnly</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>userAccountControl</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>userCertificate</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>UserPrincipalName</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>uSNChanged</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>uSNCreated</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>whenChanged</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>whenCreated</span></span></div></pre></li>
<li>To get only specific information for computer account, store output to variable and then access account attributes, see below example.<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;Enabled?</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Enabled</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Check&nbsp;if&nbsp;account&nbsp;is&nbsp;Enabled&nbsp;or&nbsp;not&nbsp;,&nbsp;it&nbsp;returns&nbsp;True/False</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Computer&nbsp;Name&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Name</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;computer&nbsp;name</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Password&nbsp;last&nbsp;changed&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.PasswordLastSet</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;last&nbsp;password&nbsp;changed&nbsp;date&nbsp;&amp;&nbsp;time.</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Last&nbsp;Logon&nbsp;Date&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.LastLogonDate</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;last&nbsp;logon&nbsp;date&nbsp;&amp;&nbsp;time.</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Computer&nbsp;FQDN&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.DNSHostName</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;computer&nbsp;FQDN</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User&nbsp;Login&nbsp;ID&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.SamAccountName</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Gives&nbsp;SAM&nbsp;ID</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;Locked&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.LockedOut</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Check&nbsp;account&nbsp;is&nbsp;locked&nbsp;True/False</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Account&nbsp;OU&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.DistinguishedName</span></span><span>&nbsp;</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Provide&nbsp;OU&nbsp;info</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Computer&nbsp;IP4&nbsp;Address&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.IPv4Address</span></span><span>&nbsp;</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Provide&nbsp;IP4&nbsp;info</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Operating&nbsp;System&nbsp;:</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`t</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>AD_computer</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.OperatingSystem</span></span><span>&nbsp;</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;Provide&nbsp;Operating&nbsp;System&nbsp;info</span></span></span></div></pre>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;Enabled?&nbsp;&nbsp;&nbsp;&nbsp;True</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Computer&nbsp;Name&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;COMPUTER1</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Password&nbsp;last&nbsp;changed&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;05/08/2018&nbsp;19:27:08</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Last&nbsp;Logon&nbsp;Date&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;05/05/2018&nbsp;17:53:12</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Computer&nbsp;FQDN&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;COMPUTER1.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>User&nbsp;Login&nbsp;ID&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;COMPUTER1$</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;Locked&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;False</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Account&nbsp;OU&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;CN=COMPUTER1,OU=Workstations,DC=test,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Computer&nbsp;IP4&nbsp;Address&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;192.168.1.10</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Operating&nbsp;System&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;Windows&nbsp;7&nbsp;Professional</span></span></div></pre></li>
</ul>
<h2 id="3-get-adorganizationalunit">3. Get-ADOrganizationalUnit</h2>
<ul>
<li><p>To get Organization Unit details</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADOrganizationalUnit</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Name&nbsp;-like&nbsp;</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>Accounts</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;DistinguishedName</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADOrganizationalUnit</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Name&nbsp;-like&nbsp;</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>User&nbsp;Accounts</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;DistinguishedName</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADOrganizationalUnit</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Name&nbsp;-like&nbsp;</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>Workstations</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;DistinguishedName</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADOrganizationalUnit</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Name&nbsp;-like&nbsp;</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>Servers</span><span class="syntax--constant syntax--character syntax--escape syntax--powershell"><span>`"</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;DistinguishedName</span></span></div></pre>
<p>Output</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DistinguishedName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>-----------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OU=Accounts,DC=test,DC=local,DC=com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OU=User&nbsp;Accounts,OU=Accounts,DC=test,DC=local,DC=com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OU=Workstations,DC=test,DC=local,DC=com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OU=Servers,DC=test,DC=local,DC=com&nbsp;&nbsp;</span></span></div></pre></li>
</ul>
<h2 id="4-get-addomain">4. Get-ADDomain</h2>
<ul>
<li><p>To get Domain details</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADDomain</span></span></span></div></pre>
<p>Output</p>
<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>AllowedDNSSuffixes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ChildDomains&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ComputersContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;OU=_New_Domain_Computers,OU=Workstations,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DeletedObjectsContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=Deleted&nbsp;Objects,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DistinguishedName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DNSRoot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DomainControllersContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;OU=Domain&nbsp;Controllers,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DomainMode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Windows2008R2Domain</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DomainSID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;S-1-5-21-1039142878-192558930-806110124</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ForeignSecurityPrincipalsContainer&nbsp;:&nbsp;CN=ForeignSecurityPrincipals,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Forest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>InfrastructureMaster&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LastLogonReplicationInterval&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LinkedGroupPolicyObjects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LostAndFoundContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=LostAndFound,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ManagedBy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;TEST</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>NetBIOSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;TEST.LOCAL</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectClass&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;domainDNS</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ObjectGUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;c443014f-6c7a-4711-ac91-b6930305667d</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ParentDomain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PDCEmulator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>QuotasContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=NTDS&nbsp;Quotas,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ReadOnlyReplicaDirectoryServers&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{DC01.test.local.com}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ReplicaDirectoryServers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{DC02.test.local.com,DC03.test.local.com}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>RIDMaster&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SubordinateReferences&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{DC=DomainDnsZones,DC=test,DC=local,DC=com}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SystemsContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=System,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>UsersContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=Users,DC=test,DC=local,DC=com&nbsp;&nbsp;</span></span></div></pre></li>
<li>Some mostly used Domain properties<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADDomain</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;DistinguishedName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>DNSRoot</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>DomainMode</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>InfrastructureMaster</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>PDCEmulator</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>RIDMaster</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>NetBIOSName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>ReplicaDirectoryServers&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;fl</span></span></div></pre>
Output<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DistinguishedName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DNSRoot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DomainMode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Windows2008R2Domain</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>InfrastructureMaster&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>PDCEmulator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>RIDMaster&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>NetBIOSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;TEST.LOCAL</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ReplicaDirectoryServers&nbsp;:&nbsp;{DC02.test.local.com,DC03.test.local.com}</span></span></div></pre></li>
</ul>
<h2 id="5-get-addomaincontroller">5. Get-ADDomainController</h2>
<ul>
<li>This Command will give details for domain Controller, you can pass DC name or it will take default DC it finds.<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADDomainController</span></span></span></div></pre>
Output<pre class="editor-colors lang-"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ComputerObjectDN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=DC03,OU=Domain&nbsp;Controllers,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>DefaultPartition&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Enabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;True</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Forest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>HostName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03.test.local.com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>InvocationId&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;df3d38de-1420-45b5-b241-78498c82db3e</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IPv4Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;135.75.88.19</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IPv6Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IsGlobalCatalog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;True</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>IsReadOnly&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;False</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>LdapPort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;389</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DC03</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>NTDSSettingsObjectDN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=NTDS&nbsp;Settings,CN=DC03,CN=Servers,CN=Sites,CN=Configuration,DC=intl,DC=att,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Windows&nbsp;Server&nbsp;2012&nbsp;R2&nbsp;Standard</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemHotfix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemServicePack&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperatingSystemVersion&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;6.3&nbsp;(9600)</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>OperationMasterRoles&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Partitions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{DC=DomainDnsZones,DC=test,DC=local,DC=com,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DC=test,DC=local,DC=com,</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DC=ForestDnsZones,DC=test,DC=local,DC=com,&nbsp;CN=Schema</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,CN=Configuration,DC=test,DC=local,DC=com...}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ServerObjectDN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;CN=DC03,CN=Servers,CN=Sites,CN=Configuration,DC=test,DC=local,DC=com</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>ServerObjectGuid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;750daf39-8ca4-4e22-b951-8cdb1c62ccca</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>Site&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>SslPort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;636</span></span></div></pre></li>
</ul>
<h2 id="5-new-aduser">5. New-ADUser</h2>
<ul>
<li><p>Using cmdlets</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>User2</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>SamAccountName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>user2</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>GivenName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>user2</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Surname&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span>'</span><span>ou=users,dc=test,local,dc=com</span><span>'</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>DisplayName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>user2</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>AccountPassword&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>null</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>CannotChangePassword&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>false</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ChangePasswordAtLogon&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>true</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>UserPrincipalName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>user2@test.local.com</span><span>"</span></span></span></div></pre>
<p>Creating users in bulk with Microsoft cmdlets</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Import-Csv</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;users2.csv&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>foreach</span></span><span>&nbsp;{</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Given</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Surname</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>SamAccountName&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Id</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>GivenName&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Given</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Surname&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Surname</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--powershell"><span>'</span><span>ou=users,dc=test,local,dc=com</span><span>'</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>DisplayName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Given</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Surname</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>AccountPassword&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>null</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>CannotChangePassword&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>false</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>ChangePasswordAtLogon&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>true</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>UserPrincipalName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--interpolated syntax--complex syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Id</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>@test.local.com</span><span>"</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>}</span></span></div></pre>
<p>Modifying user attributes.</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;user1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Set-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Department&nbsp;Geology</span></span></div></pre>
<p>Searching for a user account.</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;user1</span></span></div></pre>
<p>List Disabled user accounts</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Search-ADAccount</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>AccountDisabled&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>UsersOnly&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>select&nbsp;Name</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;distinguishedName</span></span></div></pre>
<p>Locked user accounts</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Search-ADAccount</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>LockedOut&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;Name</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>SamAccountName&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>ft</span></span></div></pre>
<p>Enabling and disabling accounts</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Disable-ADAccount</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;HSorby</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Enable-ADAccount</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;HSorby</span></span></div></pre>
<p>Moving accounts</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Move-ADObject</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>CN=HUXLEY&nbsp;Thomas,ou=starking,dc=manticore,dc=org</span><span>"</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>TargetPath&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>ou=england,dc=manticore,dc=org</span><span>"</span></span></span></div></pre>
<p>Last logon times on each DC</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>servers</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADDomainController</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;Name</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>foreach</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>server</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>in</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>servers</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>{</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;ms458j&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;SamAccountName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;lastlogon</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;lastlogondate</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;lastlogontimestamp&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Server&nbsp;</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>server</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Name</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>if</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.lastLogon</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--logical syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--constant syntax--language syntax--powershell"><span>null</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>{</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>else</span></span><span>{</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>t1</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>I</span><span>n</span><span>t</span></span><span>64</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>]</span></span><span>::Parse</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.lastLogon</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>d1</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>D</span><span>a</span><span>t</span><span>e</span><span>T</span><span>i</span><span>m</span><span>e</span><span>]</span></span><span>::FromFileTime</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>t1</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>t2</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>I</span><span>n</span><span>t</span></span><span>64</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>]</span></span><span>::Parse</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.lastLogontimestamp</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>d2</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>D</span><span>a</span><span>t</span><span>e</span><span>T</span><span>i</span><span>m</span><span>e</span><span>]</span></span><span>::FromFileTime</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>t2</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Add-Member</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>InputObject&nbsp;</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>MemberType&nbsp;Noteproperty&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>DCName</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Value&nbsp;</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>server</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.Name</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>PassThru&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Force&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Format-Table</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;SamAccountName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;DCName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;@{Name</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>LastLogonTime</span><span>"</span></span><span class="syntax--keyword syntax--other syntax--statement-separator syntax--powershell"><span>;</span></span><span>&nbsp;Expression</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>{</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>d1</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span><span>}}</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;lastlogondate</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;@{Name</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>LastLogonTimeStamp</span><span>"</span></span><span class="syntax--keyword syntax--other syntax--statement-separator syntax--powershell"><span>;</span></span><span>&nbsp;Expression</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>{</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>d2</span></span><span>}</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>}}</span></span></div></pre>
<p>Get Last logon details for user1</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;user1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>@{Name</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>ID</span><span>"</span></span><span class="syntax--keyword syntax--other syntax--statement-separator syntax--powershell"><span>;</span></span><span>&nbsp;Expression</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>{</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.samAccountName</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span><span>}}</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>@{Name</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>lastlogon</span><span>"</span></span><span class="syntax--keyword syntax--other syntax--statement-separator syntax--powershell"><span>;</span></span><span>&nbsp;Expression</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>{</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>D</span><span>a</span><span>t</span><span>e</span><span>T</span><span>i</span><span>m</span><span>e</span><span>]</span></span><span>::FromFileTime</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.lastlogon</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span><span>)</span></span></span><span>}}</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>lastlogondate</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>@{Name</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>lastlogontimestamp</span><span>"</span></span><span class="syntax--keyword syntax--other syntax--statement-separator syntax--powershell"><span>;</span></span><span>&nbsp;Expression</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>{</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span></span><span class="syntax--entity syntax--other syntax--attribute-name"><span>[</span><span>D</span><span>a</span><span>t</span><span>e</span><span>T</span><span>i</span><span>m</span><span>e</span><span>]</span></span><span>::FromFileTime</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.lastlogontimestamp</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span><span>)</span></span></span><span>}}</span></span></div></pre>
<p>Password expiration check</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;{PasswordLastSet&nbsp;</span><span class="syntax--keyword syntax--operator syntax--logical syntax--powershell"><span>-le</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>expired_date</span></span><span>}&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;PasswordLastSet&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;select&nbsp;SamAccountName</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>PasswordLastSet&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;Sort</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Object&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Property&nbsp;PasswordLastSet</span></span></div></pre>
<p>New-ADGroup</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>New-ADGroup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Name&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>English&nbsp;Scientists</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>SamAccountName&nbsp;EngSci&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>GroupCategory&nbsp;Security&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>GroupScope&nbsp;Global&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>DisplayName&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>English&nbsp;Scientists</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Path&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>OU=England,dc=manticore,dc=org</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div></pre>
<p>Changing Active Directory group membership</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Filter&nbsp;{Title&nbsp;</span><span class="syntax--keyword syntax--operator syntax--logical syntax--powershell"><span>-eq</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>Scientist</span><span>"</span></span><span>}&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>`</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>SearchBase&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--powershell"><span>"</span><span>OU=England,dc=manticore,dc=org</span><span>"</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>foreach</span></span><span>&nbsp;{</span><span class="syntax--support syntax--function syntax--powershell"><span>Add-ADGroupMember</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;EngSci&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Members&nbsp;</span><span class="syntax--meta syntax--group syntax--complex syntax--subexpression syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$(</span><span>$</span></span><span class="syntax--support syntax--constant syntax--automatic syntax--powershell"><span>_</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.DistinguishedName</span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span></span><span>&nbsp;}</span></span></div></pre>
<p>Changing Active Directory group scope</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADGroup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;testgrp&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;get&nbsp;scope</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Set-ADGroup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;testgrp&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>GroupScope&nbsp;Universal&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;change&nbsp;scope</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADGroup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;testgrp&nbsp;</span><span class="syntax--comment syntax--line syntax--number-sign syntax--powershell"><span>#</span><span>#&nbsp;check&nbsp;scope&nbsp;again</span></span></span></div></pre>
<p>Finding group members</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADGroupMember</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;testgrp&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;Name</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;distinguishedname</span></span></div></pre>
<p>Get nested group membership</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADGroupMember</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Identity&nbsp;testgrp&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Recursive&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;Name</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>,</span></span><span>&nbsp;distinguishedname</span></span></div></pre>
<p>Finding a users group membership</p>
<pre class="editor-colors lang-powershell"><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADUser</span></span><span>&nbsp;user1&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>-</span></span><span>Properties&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--powershell"><span>*</span></span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span class="syntax--keyword syntax--control syntax--powershell"><span>foreach</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>(</span></span><span class="syntax--interpolated syntax--simple syntax--source syntax--powershell"><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>group</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--powershell"><span>in</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>user</span></span><span class="syntax--entity syntax--name syntax--function syntax--invocation syntax--powershell"><span>.memberof</span></span></span><span class="syntax--keyword syntax--other syntax--powershell"><span>)</span></span><span>{</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--function syntax--powershell"><span>Get-ADGroup</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--other syntax--powershell"><span>$</span></span><span class="syntax--variable syntax--other syntax--readwrite syntax--powershell"><span>group</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--other syntax--powershell"><span>|</span></span><span>&nbsp;select&nbsp;Name</span></span></div><div class="line"><span class="syntax--source syntax--powershell"><span>&nbsp;&nbsp;}</span></span></div></pre>
</li>
</ul></body>
</html>
